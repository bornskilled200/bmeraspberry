<html>

<head>
  <title>Express</title>
  <link rel="stylesheet" href="/stylesheets/style.css">
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>

<body>
  <h1>Express</h1>
  <p>Welcome to Express</p>
  <div id="air" class="plotly-frame"></div>
  <div id="humidity" class="plotly-frame"></div>
  <div id="temp" class="plotly-frame"></div>

  <script>
  	const airDiv = document.getElementById('air');
  	const humidityDiv = document.getElementById('humidity');
  	const tempDiv = document.getElementById('temp');

  	fetch('conditions')
  		.then(response => response.json())
  		.then(conditions => {
  			const x = conditions.map(condition => new Date(condition.time * 1000));
			Plotly.plot(
				airDiv,
				[
					{
						x,
						y: conditions.map(condition => condition.air) 
					}
				],
				{
					margin: { t: 0 }
				}
			);
			Plotly.plot(
				humidityDiv,
				[
					{
						x,
						y: conditions.map(condition => condition.humidity) 
					}
				],
				{
					margin: { t: 0 }
				}
			);
			Plotly.plot(
				tempDiv,
				[
					{
						x,
						y: conditions.map(condition => condition.temperature) 
					}
				],
				{
					margin: { t: 0 }
				}
			);
	  	});
  </script>
</body>

</html>
